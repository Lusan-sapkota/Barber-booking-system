{% extends "base.html" %}

{% block title %}Book an Appointment{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="text-center">Book Your Appointment</h1>
            <p class="text-center text-muted">Choose your service, date, and preferred time slot</p>
        </div>
    </div>

    <div class="row">
        <!-- Service Selection -->
        <div class="col-md-4">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0"><i class="fas fa-list me-2"></i>Select Service</h5>
                </div>
                <div class="card-body">
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="service" id="haircut" value="1">
                        <label class="form-check-label d-flex justify-content-between" for="haircut">
                            <span>Haircut</span>
                            <span class="badge bg-dark">$25</span>
                        </label>
                        <small class="text-muted d-block">30 minutes</small>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="service" id="haircut-beard" value="2">
                        <label class="form-check-label d-flex justify-content-between" for="haircut-beard">
                            <span>Haircut + Beard Trim</span>
                            <span class="badge bg-dark">$35</span>
                        </label>
                        <small class="text-muted d-block">45 minutes</small>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="service" id="beard-trim" value="3">
                        <label class="form-check-label d-flex justify-content-between" for="beard-trim">
                            <span>Beard Trim</span>
                            <span class="badge bg-dark">$15</span>
                        </label>
                        <small class="text-muted d-block">15 minutes</small>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="service" id="premium" value="4">
                        <label class="form-check-label d-flex justify-content-between" for="premium">
                            <span>Premium Package</span>
                            <span class="badge bg-dark">$50</span>
                        </label>
                        <small class="text-muted d-block">60 minutes - Includes haircut, beard trim, and styling</small>
                    </div>
                </div>
            </div>

            <!-- Date Selection -->
            <div class="card shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Select Date</h5>
                </div>
                <div class="card-body">
                    <input type="date" id="appointment-date" class="form-control" min="{{ today_date }}" required>
                    <small class="text-muted d-block mt-2">We're open Monday to Friday: 10:00 AM - 4:00 PM</small>
                </div>
            </div>
        </div>

        <!-- Time Slots -->
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Available Time Slots</h5>
                </div>
                <div class="card-body">
                    <div id="time-slots" class="time-slots-container">
                        <div class="text-center py-5 text-muted">
                            <i class="fas fa-calendar-day fa-3x mb-3"></i>
                            <p>Please select a service and date to view available time slots</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Customer Information (only shown after selecting a time slot) -->
            <div id="customer-info" class="card shadow-sm mt-4 d-none">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0"><i class="fas fa-user me-2"></i>Your Information</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="customer-name" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="customer-name" required>
                        </div>
                        <div class="col-md-6">
                            <label for="customer-phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="customer-phone" required>
                        </div>
                        <div class="col-12">
                            <label for="customer-email" class="form-label">Email Address</label>
                            <input type="email" class="form-control" id="customer-email" required>
                        </div>
                        <div class="col-12">
                            <label for="customer-notes" class="form-label">Special Requests (Optional)</label>
                            <textarea class="form-control" id="customer-notes" rows="2"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Booking Action -->
    <div class="row mt-4">
        <div class="col-12 text-center">
            <button id="book-btn" class="btn btn-primary btn-lg px-5" disabled>
                <i class="fas fa-calendar-check me-2"></i>Book Appointment
            </button>
        </div>
    </div>

    <!-- Booking Summary Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title" id="bookingModalLabel">Confirm Your Booking</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="booking-summary">
                        <div class="d-flex justify-content-between mb-2">
                            <strong>Service:</strong>
                            <span id="summary-service"></span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <strong>Date:</strong>
                            <span id="summary-date"></span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <strong>Time:</strong>
                            <span id="summary-time"></span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <strong>Barber:</strong>
                            <span id="summary-barber">Available barber</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <strong>Total:</strong>
                            <span id="summary-price" class="text-primary fw-bold"></span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirm-booking">Confirm Booking</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .time-slots-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
    }
    
    .time-slot {
        padding: 10px;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .time-slot:hover {
        background-color: #f8f9fa;
        border-color: #ced4da;
    }
    
    .time-slot.selected {
        background-color: #0d6efd;
        color: white;
        border-color: #0d6efd;
    }
    
    .booking-summary {
        font-size: 1.1em;
    }
</style>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/booking.js') }}"></script>
{% endblock %}