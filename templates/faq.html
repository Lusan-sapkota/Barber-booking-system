{% extends "base.html" %}

{% block title %}FAQ - BookaBarber{% endblock %}

{% block extra_css %}
<style>
/* Dark/Light Mode Variables */
:root {
    /* Light Mode (Default) */
    --bg-color: #f8f9fa;
    --card-bg: #ffffff;
    --text-color: #212529;
    --text-muted: #6c757d;
    --border-color: #dee2e6;
    --card-shadow: 0 5px 15px rgba(0,0,0,0.1);
    --primary-color: #0d6efd;
    --primary-hover: #0a58ca;
    --danger-color: #dc3545;
    --success-color: #28a745;
    --warning-color: #ffc107;
    --info-color: #17a2b8;
    --hero-gradient-start: #0d6efd;
    --hero-gradient-end: #0b5ed7;
    --hero-text: #ffffff;
    --search-bg: rgba(255, 255, 255, 0.15);
    --question-bg: #f8f9fa;
    --question-hover-bg: #e9ecef;
    --question-active-bg: #0d6efd;
    --question-active-color: #ffffff;
    --answer-bg: #ffffff;
    --popular-badge-bg: #ff6b6b;
    --search-stats-bg: #e7f3ff;
    --icon-bg: linear-gradient(135deg, #0d6efd, #0b5ed7);
    --alert-info-bg: #cff4fc;
    --alert-info-color: #055160;
    --alert-warning-bg: #fff3cd;
    --alert-warning-color: #664d03;
    --btn-outline-color: #0d6efd;
    --btn-outline-hover-bg: #0d6efd;
    --btn-outline-hover-color: #ffffff;
    --faq-link-color: #0d6efd;
}

[data-theme="dark"] {
    /* Dark Mode Variables */
    --bg-color: #121212;
    --card-bg: #1e1e1e;
    --text-color: #e0e0e0;
    --text-muted: #a0a0a0;
    --border-color: #333333;
    --card-shadow: 0 5px 15px rgba(0,0,0,0.3);
    --primary-color: #63a9ff;
    --primary-hover: #4d8fd6;
    --danger-color: #e74c3c;
    --success-color: #2ea04a;
    --warning-color: #ffca2c;
    --info-color: #3abbd3;
    --hero-gradient-start: #0a3b79;
    --hero-gradient-end: #092d5e;
    --hero-text: #ffffff;
    --search-bg: rgba(0, 0, 0, 0.3);
    --question-bg: #2d2d2d;
    --question-hover-bg: #3d3d3d;
    --question-active-bg: #63a9ff;
    --question-active-color: #ffffff;
    --answer-bg: #1e1e1e;
    --popular-badge-bg: #e74c3c;
    --search-stats-bg: #1a3b5a;
    --icon-bg: linear-gradient(135deg, #0a3b79, #0a4b99);
    --alert-info-bg: #0f3a4d;
    --alert-info-color: #87d3e2;
    --alert-warning-bg: #3d3013;
    --alert-warning-color: #ffde87;
    --btn-outline-color: #63a9ff;
    --btn-outline-hover-bg: #63a9ff;
    --btn-outline-hover-color: #1e1e1e;
    --faq-link-color: #63a9ff;
}

/* Base Page Styling */
.faq-page {
    background-color: var(--bg-color);
    color: var(--text-color);
    transition: all 0.3s ease;
    min-height: 100vh;
}

/* Hero Section */
.faq-hero {
    background: linear-gradient(135deg, var(--hero-gradient-start) 0%, var(--hero-gradient-end) 100%);
    color: var(--hero-text);
    padding: 4rem 0;
    position: relative;
    overflow: hidden;
    transition: background 0.3s ease;
}

.faq-hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    z-index: 1;
}

.faq-hero .container {
    position: relative;
    z-index: 2;
}

.faq-search {
    background: var(--search-bg);
    border-radius: 15px;
    padding: 2rem;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    transition: background 0.3s ease;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

[data-theme="dark"] .faq-search {
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

.faq-search input.form-control {
    background: var(--card-bg);
    color: var(--text-color);
    border-color: var(--border-color);
    transition: all 0.3s ease;
}

.faq-search .btn-light {
    background: var(--card-bg);
    color: var(--text-color);
    border-color: var(--border-color);
    transition: all 0.3s ease;
}

.faq-search .btn-light:hover {
    background: var(--primary-hover);
    color: white;
}

/* Search Results Stats */
.search-stats {
    background: var(--search-stats-bg);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 2rem;
    text-align: center;
    color: var(--text-color);
    transition: all 0.3s ease;
}

/* FAQ Category */
.faq-category {
    background: var(--card-bg);
    border-radius: 15px;
    padding: 2rem;
    box-shadow: var(--card-shadow);
    margin-bottom: 2rem;
    transition: all 0.3s ease;
    border: 1px solid var(--border-color);
}

.faq-category h3 {
    color: var(--text-color);
    transition: color 0.3s ease;
}

/* Category Icon */
.category-icon {
    width: 50px;
    height: 50px;
    background: var(--icon-bg);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
    margin-bottom: 1rem;
    transition: all 0.3s ease;
}

/* FAQ Items */
.faq-item {
    border: 1px solid var(--border-color);
    border-radius: 10px;
    margin-bottom: 1rem;
    overflow: hidden;
    transition: all 0.3s ease;
}

.faq-item:hover {
    box-shadow: var(--card-shadow);
}

/* Question Button */
.faq-question {
    background: var(--question-bg);
    padding: 1rem 1.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
    width: 100%;
    text-align: left;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 500;
    color: var(--text-color);
}

.faq-question:hover {
    background: var(--question-hover-bg);
}

.faq-question.active {
    background: var(--question-active-bg);
    color: var(--question-active-color);
}

/* Answer Styling */
.faq-answer {
    padding: 1.5rem;
    background: var(--answer-bg);
    display: none;
    border-top: 1px solid var(--border-color);
    color: var(--text-color);
    transition: all 0.3s ease;
}

.faq-answer.show {
    display: block;
    animation: fadeIn 0.4s ease;
}

/* Popular Badge */
.popular-badge {
    background: var(--popular-badge-bg);
    color: white;
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 10px;
    margin-left: 0.5rem;
    transition: background 0.3s ease;
}

/* Alert Styling */
.alert-info {
    background-color: var(--alert-info-bg);
    color: var(--alert-info-color);
    border-color: transparent;
    transition: all 0.3s ease;
}

.alert-warning {
    background-color: var(--alert-warning-bg);
    color: var(--alert-warning-color);
    border-color: transparent;
    transition: all 0.3s ease;
}

/* Button Styling */
.btn-primary {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    transition: all 0.3s ease;
}

.btn-primary:hover {
    background: var(--primary-hover);
    border-color: var(--primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

[data-theme="dark"] .btn-primary:hover {
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.btn-outline-primary {
    color: var(--btn-outline-color);
    border-color: var(--btn-outline-color);
    transition: all 0.3s ease;
}

.btn-outline-primary:hover {
    background: var(--btn-outline-hover-bg);
    color: var(--btn-outline-hover-color);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

[data-theme="dark"] .btn-outline-primary:hover {
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* Text Colors */
.text-muted {
    color: var(--text-muted) !important;
    transition: color 0.3s ease;
}

.text-primary {
    color: var(--primary-color) !important;
    transition: color 0.3s ease;
}

.text-danger {
    color: var(--danger-color) !important;
    transition: color 0.3s ease;
}

.text-success {
    color: var(--success-color) !important;
    transition: color 0.3s ease;
}

/* Links in FAQ answers */
.faq-answer a {
    color: var(--faq-link-color);
    transition: color 0.3s ease;
}

/* Highlighted search terms */
mark {
    background-color: var(--primary-color);
    color: white;
    padding: 0 0.2rem;
    border-radius: 3px;
    transition: all 0.3s ease;
}

[data-theme="dark"] mark {
    background-color: var(--primary-hover);
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Dark Mode Toggle Button */
.dark-mode-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
    width: 50px;
    height: 50px;
    background: var(--card-bg);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    color: var(--text-color);
    font-size: 1.2rem;
}

.dark-mode-toggle:hover {
    transform: scale(1.1);
}

/* Mobile Responsive Fixes */
@media (max-width: 767px) {
    .faq-hero {
        padding: 3rem 0;
    }
    
    .faq-search {
        padding: 1.5rem;
    }
    
    .faq-category {
        padding: 1.5rem;
    }
    
    .faq-question {
        padding: 0.75rem 1rem;
    }
    
    .faq-answer {
        padding: 1rem;
    }
    
    .btn-lg {
        padding: 0.5rem 1rem;
        font-size: 1rem;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="faq-page">
    <!-- Hero Section -->
    <section class="faq-hero">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center">
                    <h1 class="display-4 mb-3">Frequently Asked Questions</h1>
                    <p class="lead mb-4">Find quick answers to the most common questions about BookaBarber</p>
                    
                    <div class="faq-search">
                        <div class="input-group input-group-lg">
                            <input type="text" class="form-control" placeholder="Search FAQs..." id="faq-search">
                            <button class="btn btn-light" type="button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <small class="text-white-50 d-block mt-2">
                            <i class="fas fa-lightbulb me-1"></i>
                            Try searching for "booking", "payment", "cancel", or "account"
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="container py-5">
        <!-- Search Results Stats -->
        <div class="search-stats" id="search-stats" style="display: none;">
            <i class="fas fa-search me-2"></i>
            <span id="search-results-text">Showing all questions</span>
        </div>

        <!-- Popular Questions -->
        <div class="faq-category">
            <div class="category-icon">
                <i class="fas fa-fire"></i>
            </div>
            <h3 class="mb-3">Most Popular Questions</h3>
            
            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>How do I book an appointment? <span class="popular-badge">Popular</span></span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Booking is easy and takes just a few minutes:</strong></p>
                    <ol>
                        <li><strong>Find a Barber:</strong> Use our "Find Nearby" feature or browse available barbers</li>
                        <li><strong>Select Service:</strong> Choose from haircut, beard trim, or premium packages</li>
                        <li><strong>Pick Date & Time:</strong> Select your preferred appointment slot</li>
                        <li><strong>Enter Details:</strong> Provide your contact information</li>
                        <li><strong>Confirm:</strong> Review and confirm your booking</li>
                    </ol>
                    <div class="alert alert-info mt-3">
                        <i class="fas fa-info-circle me-2"></i>
                        You'll receive a confirmation email with all the details and can manage your booking from your dashboard.
                    </div>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>Can I cancel or reschedule my appointment? <span class="popular-badge">Popular</span></span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Yes! We offer flexible cancellation and rescheduling:</strong></p>
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-times-circle text-danger me-2"></i>Cancellation</h6>
                            <ul>
                                <li><strong>Free:</strong> 24+ hours before appointment</li>
                                <li><strong>Fee applies:</strong> 2-24 hours before</li>
                                <li><strong>Full charge:</strong> No-show or last minute</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-calendar-alt text-primary me-2"></i>Rescheduling</h6>
                            <ul>
                                <li><strong>Free:</strong> Up to 2 hours before</li>
                                <li><strong>Multiple times:</strong> No limit on changes</li>
                                <li><strong>Easy process:</strong> Via dashboard or call us</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>What payment methods do you accept? <span class="popular-badge">Popular</span></span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>We accept all major payment methods:</strong></p>
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-credit-card text-primary me-2"></i>Cards</h6>
                            <ul>
                                <li>Visa, MasterCard, American Express</li>
                                <li>Debit cards with Visa/MC logo</li>
                                <li>Secure processing with encryption</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-mobile-alt text-success me-2"></i>Digital Wallets</h6>
                            <ul>
                                <li>PayPal and PayPal Credit</li>
                                <li>Apple Pay and Google Pay</li>
                                <li>Cash payment at the shop</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Booking & Appointments -->
        <div class="faq-category" id="booking-category">
            <div class="category-icon">
                <i class="fas fa-calendar-plus"></i>
            </div>
            <h3 class="mb-3">Booking & Appointments</h3>
            
            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>How far in advance can I book?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p>You can book appointments up to <strong>30 days in advance</strong>. Popular time slots (evenings and weekends) tend to fill up quickly, so we recommend booking as early as possible.</p>
                    <p>For same-day appointments, check our app throughout the day as barbers often have last-minute availability.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>What if I'm running late?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Please call the barber immediately if you're running late.</strong></p>
                    <ul>
                        <li><strong>5-10 minutes late:</strong> Usually accommodated</li>
                        <li><strong>10-15 minutes late:</strong> Service may be shortened</li>
                        <li><strong>15+ minutes late:</strong> Appointment may be canceled</li>
                    </ul>
                    <div class="alert alert-warning">
                        <i class="fas fa-clock me-2"></i>
                        Late arrivals may affect the quality of service and impact other customers' appointments.
                    </div>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>Can I request a specific barber?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Absolutely!</strong> You can choose a specific barber in two ways:</p>
                    <ol>
                        <li><strong>Browse & Select:</strong> Use our "Find Nearby" page to browse barbers and their profiles</li>
                        <li><strong>Auto-Assignment:</strong> Use quick booking and we'll assign the best available barber based on your preferences</li>
                    </ol>
                    <p>Each barber's profile shows their specialties, ratings, and available time slots.</p>
                </div>
            </div>
        </div>

        <!-- Account & Profile -->
        <div class="faq-category" id="account-category">
            <div class="category-icon">
                <i class="fas fa-user-circle"></i>
            </div>
            <h3 class="mb-3">Account & Profile</h3>
            
            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>Do I need to create an account to book?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Yes, an account is required</strong> to ensure the best experience:</p>
                    <ul>
                        <li><strong>Track Appointments:</strong> View past and upcoming bookings</li>
                        <li><strong>Quick Rebooking:</strong> Faster checkout with saved information</li>
                        <li><strong>Preferences:</strong> Save your favorite barbers and services</li>
                        <li><strong>Notifications:</strong> Receive appointment reminders</li>
                        <li><strong>Reviews:</strong> Rate and review your experiences</li>
                    </ul>
                    <p>Creating an account takes less than 2 minutes!</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>How do I reset my password?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Password reset is simple:</strong></p>
                    <ol>
                        <li>Go to the <a href="{{ url_for('login') }}">login page</a></li>
                        <li>Click "Forgot Password?"</li>
                        <li>Enter your email address</li>
                        <li>Check your email for reset instructions</li>
                        <li>Follow the link to create a new password</li>
                    </ol>
                    <div class="alert alert-info">
                        <i class="fas fa-envelope me-2"></i>
                        Don't see the email? Check your spam folder or try again with the correct email address.
                    </div>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>How do I delete my account?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>To delete your account:</strong></p>
                    <ol>
                        <li>Log into your account</li>
                        <li>Go to Profile Settings</li>
                        <li>Scroll down to "Account Management"</li>
                        <li>Click "Delete Account"</li>
                        <li>Confirm the deletion</li>
                    </ol>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Warning:</strong> This action cannot be undone. All your booking history and preferences will be permanently deleted.
                    </div>
                </div>
            </div>
        </div>

        <!-- For Barbers -->
        <div class="faq-category" id="barber-category">
            <div class="category-icon">
                <i class="fas fa-cut"></i>
            </div>
            <h3 class="mb-3">For Barbers & Shop Owners</h3>
            
            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>How do I join BookaBarber as a barber?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Joining is easy and free:</strong></p>
                    <ol>
                        <li><strong>Sign Up:</strong> Create a barber account on our platform</li>
                        <li><strong>Profile Setup:</strong> Add your photo, specialties, and experience</li>
                        <li><strong>Verification:</strong> Upload required certifications and ID</li>
                        <li><strong>Shop Association:</strong> Connect with a barbershop or register as independent</li>
                        <li><strong>Go Live:</strong> Start accepting bookings!</li>
                    </ol>
                    <p>Our team will review your application within 24-48 hours.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>How do I get paid?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Payment is simple and secure:</strong></p>
                    <ul>
                        <li><strong>Direct Deposit:</strong> Weekly payments to your bank account</li>
                        <li><strong>Dashboard Tracking:</strong> Real-time earnings tracking</li>
                        <li><strong>Fee Structure:</strong> Competitive commission rates</li>
                        <li><strong>Instant Payouts:</strong> Available for premium members</li>
                    </ul>
                    <p>Set up your payment information in your barber dashboard.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question" onclick="toggleFaq(this)">
                    <span>Can I set my own prices?</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    <p><strong>Yes!</strong> You have full control over your pricing:</p>
                    <ul>
                        <li>Set individual prices for each service</li>
                        <li>Offer package deals and discounts</li>
                        <li>Adjust prices based on demand</li>
                        <li>Set different rates for peak hours</li>
                    </ul>
                    <p>We provide pricing recommendations based on your location and experience level.</p>
                </div>
            </div>
        </div>

        <!-- Still Need Help -->
        <div class="faq-category">
            <div class="text-center">
                <h4 class="mb-3">Still have questions?</h4>
                <p class="text-muted mb-4">Can't find what you're looking for? Our support team is here to help!</p>
                <div class="row justify-content-center">
                    <div class="col-md-4 mb-3">
                        <a href="{{ url_for('contactus') }}" class="btn btn-primary btn-lg w-100">
                            <i class="fas fa-envelope me-2"></i>Contact Support
                        </a>
                    </div>
                    <div class="col-md-4 mb-3">
                        <a href="{{ url_for('helpcenter') }}" class="btn btn-outline-primary btn-lg w-100">
                            <i class="fas fa-question-circle me-2"></i>Help Center
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleFaq(button) {
    const answer = button.nextElementSibling;
    const icon = button.querySelector('i');
    const isActive = answer.classList.contains('show');
    
    // Close all other FAQ items
    document.querySelectorAll('.faq-answer.show').forEach(item => {
        if (item !== answer) {
            item.classList.remove('show');
            item.previousElementSibling.classList.remove('active');
            item.previousElementSibling.querySelector('i').className = 'fas fa-chevron-down';
        }
    });
    
    // Toggle current item
    answer.classList.toggle('show');
    button.classList.toggle('active');
    
    if (answer.classList.contains('show')) {
        icon.className = 'fas fa-chevron-up';
    } else {
        icon.className = 'fas fa-chevron-down';
    }
}

// Enhanced search functionality
document.getElementById('faq-search').addEventListener('keyup', function(e) {
    const searchTerm = e.target.value.toLowerCase();
    const faqItems = document.querySelectorAll('.faq-item');
    const searchStats = document.getElementById('search-stats');
    const searchResultsText = document.getElementById('search-results-text');
    let visibleCount = 0;
    
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question span').textContent.toLowerCase();
        const answer = item.querySelector('.faq-answer').textContent.toLowerCase();
        
        if (question.includes(searchTerm) || answer.includes(searchTerm)) {
            item.style.display = 'block';
            visibleCount++;
            
            // Highlight search terms
            if (searchTerm) {
                const questionElement = item.querySelector('.faq-question span');
                const originalText = questionElement.textContent;
                const highlightedText = originalText.replace(new RegExp(searchTerm, 'gi'), `<mark>$&</mark>`);
                questionElement.innerHTML = highlightedText;
            }
        } else {
            item.style.display = searchTerm ? 'none' : 'block';
            if (!searchTerm) visibleCount++;
        }
    });
    
    // Update search stats
    if (searchTerm) {
        searchStats.style.display = 'block';
        searchResultsText.textContent = `Found ${visibleCount} question${visibleCount !== 1 ? 's' : ''} matching "${searchTerm}"`;
    } else {
        searchStats.style.display = 'none';
        // Reset highlighting
        document.querySelectorAll('.faq-question span').forEach(span => {
            span.innerHTML = span.textContent;
        });
    }
});

// Category filtering
function filterByCategory(category) {
    const faqItems = document.querySelectorAll('.faq-item');
    
    faqItems.forEach(item => {
        const categoryElement = item.closest('.faq-category');
        const categoryId = categoryElement.id;
        
        if (category === 'all' || categoryId === category) {
            item.style.display = 'block';
        } else {
            item.style.display = 'none';
        }
    });
}

// Create dark mode toggle
document.addEventListener('DOMContentLoaded', function() {
    // Create dark mode toggle
    const toggleButton = document.createElement('button');
    toggleButton.classList.add('dark-mode-toggle');
    toggleButton.setAttribute('aria-label', 'Toggle dark mode');
    toggleButton.innerHTML = '<i class="fas fa-moon"></i>';
    toggleButton.addEventListener('click', toggleDarkMode);
    document.body.appendChild(toggleButton);
    
    // Check for saved theme preference
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
        toggleButton.innerHTML = savedTheme === 'dark' ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
    }
    
    function toggleDarkMode() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        if (currentTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('theme', 'light');
            toggleButton.innerHTML = '<i class="fas fa-moon"></i>';
        } else {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('theme', 'dark');
            toggleButton.innerHTML = '<i class="fas fa-sun"></i>';
        }
    }
});
</script>
{% endblock %}